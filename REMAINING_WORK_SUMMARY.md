# Moment Catcher - 完整需求梳理与优先级排序

**日期：** 2025-12-15  
**状态：** 后端逻辑完成，前端待开发  
**原则：** MECE（相互独立，完全穷尽）

---

## ✅ 已完成部分

### 后端核心逻辑（100%）
- ✅ LLM 对话生成（Qwen-Max）
- ✅ TTS 语音合成（CosyVoice，语音克隆）
- ✅ ASR 语音识别（Paraformer-v2）
- ✅ RAG 记忆系统（Style RAG + Context RAG）
- ✅ Moment 管理（创建、保存、加载）
- ✅ Moment Card 生成（总结、标题、情绪标签）
- ✅ 多用户数据隔离
- ✅ 记忆系统稳定性测试（7轮全PASS）

### FastAPI 后端（100%）
- ✅ REST API 封装（8个端点）
- ✅ CORS配置
- ✅ API文档（Swagger UI）
- ✅ 测试脚本验证通过

### React 前端基础（75%）
- ✅ 项目结构搭建
- ✅ Landing Page（基础版，含动画和字体）
- ✅ 主页面布局重构（三按钮布局 + 5块状态信息）
- ✅ 文字输入对话（基础版）
- ✅ ASR 语音识别集成（录音、上传、识别）
- ✅ 实时字幕显示（滚动字幕式）
- ✅ 情绪识别和显示
- ✅ 说话人显示（用户自定义名字）
- ✅ 音频处理状态切换
- ✅ Memories 星轨图（Canvas 2D版，带闪烁效果）
- ✅ Moment Card 样式（浮现动画、彩色边框、手写字体）
- ✅ 设置页面（基础版，含重命名功能）
- ✅ **背景选择功能**（3D传送带选择器，动态加载星体素材）
- ✅ **粒子背景基础版**（Three.js粒子系统，交互效果）
- ✅ **背景状态管理**（sessionChoiceMade + sessionUserId，区分新登录和会话内切换）

---

## 📋 待办需求（按 MECE 原则分类）

### 一、页面和界面（UI Components）

#### 1.1 Landing Page（命名页）
**当前状态：** 基础版已实现  
**需要优化：**

**P0 - 核心功能：**
- [ ] 浮现特效（fade in + scale，0.5s）
- [ ] 标题霓虹紫蓝发光效果（CSS text-shadow + animation）
- [ ] 输入框手写字体样式（cursive）
- [ ] 输入框激活状态（下划线变亮蓝色）
- [ ] 点击 INITIATE LINK 跳转主页面

**设计规范：**
- 背景：纯黑色 (#000000)
- 标题：科幻字体，霓虹紫蓝发光 (#9370DB, #667eea)
- 输入内容：手写字体，白色或浅蓝色
- 动画：浮现特效（自然出现）

---

#### 1.2 主页面（Main Interface）
**当前状态：** ✅ 三按钮布局已完成，✅ 5块状态信息已完成  
**需要优化：**

**P0 - 核心功能（待完成）：**
- [x] **聊天布局重构**（舞台剧场模式）：
  - ✅ 前端：只显示最新一条消息（Agent 和 User 各一条），固定高度对话框
  - ✅ 后端：完整消息历史存档（用于 RAG 回溯），已实现
  - ✅ 5块状态信息布局（音频状态、情绪、说话人、对话区域、输入框）
  - ✅ Processing 期间显示上一条消息逻辑
  - ✅ 绝对定位输入框，固定在底部
- [x] **语音识别即时显示**：
  - ✅ 识别成功后，**直接作为用户消息显示**，无需文本框确认
  - ✅ 识别文本立即添加到消息列表
  - ✅ 自动触发 AI 回复流程
- [x] **背景选择功能**（3D传送带选择器）：
  - ✅ 3D传送带式背景选择器（点击选择，支持左右滑动浏览）
  - ✅ 动态加载星体素材文件夹下的所有图片
  - ✅ 选中的背景用于该 Moment 的对话背景
  - ✅ 背景状态管理（每次登录都选背景，从Memories返回不选背景）
  - ✅ 背景持久化（保存到localStorage，按用户ID隔离）
  - ⏳ 左右滑动选择优化（当前是点击选择，可优化为滑动确认）
  - ⏳ 保存后成为 Memory Card 的封面（待实现）
- [x] **粒子背景集成**（基础版已完成）：
  - ✅ 将选中的星图背景嵌入到聊天主页面
  - ✅ Three.js粒子系统（基于背景图生成交互式粒子）
  - ✅ 粒子交互效果（鼠标/触摸移动粒子）
  - ⏳ 粒子颜色随情绪变化（后续实现）
  - ⏳ 粒子数量自适应（移动端减少，后续实现）

**已完成：**
- ✅ 布局重构：三个主按钮（底部水平排列）
- ✅ 设置按钮：右上角（齿轮图标）
- ✅ 状态显示系统（5块信息，从上到下垂直分布）
- ✅ 实时字幕显示（滚动字幕式）
- ✅ 语音识别集成（录音、上传、识别）

---

#### 1.3 Capture 弹窗
**当前状态：** 未实现  
**需要实现：**

**P0 - 核心功能：**
- [ ] 点击 CAPTURE 按钮后，悬浮弹窗出现在主页面上方
- [ ] 弹窗内容：
  - 问题："Freeze this moment?"（手写字体）
  - 两个按钮：
    - "CRYSTALLIZE"（蓝色背景，主要操作）
    - "FADE"（深灰色背景，取消）
- [ ] 背景：主页面内容可见但模糊（backdrop blur）
- [ ] 点击 CRYSTALLIZE 触发保存 Moment

---

#### 1.4 Moment Card
**当前状态：** 基础列表显示（需要重构为卡片样式）  
**需要实现：**

**P0 - 核心功能：**
- [ ] **浮现动画**：卡片逐渐浮现（fade in + scale，0.6s），不会直接跳出
- [ ] **卡片样式**：
  - 深灰色圆角矩形
  - **左侧彩色边框**（颜色 = 情绪颜色，如黄色 Joy、蓝色 Sadness）
  - 标题：大号手写风格字体，白色
  - 日期：小号科幻字体，右上角（如 "2025/12/15"）
  - 正文：手写风格字体，白色，多行
  - 关闭按钮：右上角 X 图标
- [ ] **背景**：黑色，有模糊的光效（紫色/蓝色）
- [ ] **内容包含**：标题、日期、正文（第一人称叙事）

**关键细节：**
- 边框颜色 = 情绪颜色 = 实时对话中的情绪颜色
- 手写字体用于标题和正文

---

#### 1.5 Memories（Memory Nebula）
**当前状态：** ✅ Canvas 2D 星轨图已完成（带闪烁效果）  
**需要优化：**

**P1 - 重要功能（3D 化）：**
- [ ] **3D 空间感增强**（参考 `memories参考.png`）：
  - 当前是平面 2D Canvas，需要改为 **3D 空间展现**
  - 参考 `UI demo/星体素材/memories参考.png` 的单个星体渲染效果
  - 在 2D 显示效果的基础上，做成 **3D 化展现**（类似视频截图的 3D 效果）
  - 星体需要有**空间纵深感和层次感**（Z 轴深度）
  - 星体由近到远：最近的在前方（大、亮），远的在后方（小、暗）
- [ ] **技术实现**：
  - 使用 Three.js 渲染 3D 星体（或增强 Canvas 2D 的 3D 视觉效果）
  - 相机视角：透视投影，营造空间感
  - 星体渲染：参考 `memories参考.png` 的星体样式（光晕、渐变、发光效果）
  - 星体颜色：情绪颜色映射（已实现）
  - 星体位置：3D 空间分布（X, Y, Z 坐标）
- [ ] **交互增强**：
  - 点击星体 → 打开对应的 Moment Card（已实现）
  - 悬停高亮效果
  - 相机旋转/缩放（可选，P2）

**已完成：**
- ✅ 星轨图基础版（Canvas 2D，纯黑背景）
- ✅ 星体闪烁效果
- ✅ 星体颜色映射（情绪颜色）
- ✅ 点击交互（打开 Moment Card）
- ✅ 头部信息显示（MEMORY NEBULA, FRAGMENTS FOUND）

**注意：**
- **不需要**参考视频的碎片形式（用户自定义图片上传）
- **需要**：在现有星图模式基础上增强 3D 空间感

---

#### 1.6 设置页面
**当前状态：** ✅ 基础版已实现，✅ 重命名功能已实现  
**已完成：**

**P0 - 核心功能：**
- ✅ 显示当前 TRAVELER 和 COMPANION 名字
- ✅ 名字显示：手写字体 + 渐变颜色
  - COMPANION：紫色-粉色渐变
  - TRAVELER：蓝色-紫色渐变
- ✅ 可编辑输入框（参考 Landing Page 设计）
- ✅ 点击名字进入编辑模式
- ✅ 保存/取消按钮
- ✅ 重命名功能（调用后端 API `/api/update-names`）
- ✅ 后端重命名逻辑：重命名所有相关用户数据，不删除之前的记录
  - 重命名 Moments 目录
  - 重命名风格数据文件
  - 更新管理器实例
  - 合并数据（如果新名字已存在）
- ✅ 前端状态更新（更新 userInfo）
- ✅ 错误和成功消息提示

---

### 二、交互功能（Interaction Features）

#### 2.1 语音识别（ASR）
**当前状态：** ✅ 后端已实现，✅ 前端已集成  
**需要优化：**

**P0 - 核心功能（待完成）：**
- [ ] **识别结果即时显示**（参考视频"语音对话进行中"截图）：
  - 识别成功后，**直接作为用户消息显示**，无需文本框确认
  - 识别文本立即添加到消息列表（用户消息）
  - 自动触发 AI 回复流程（调用 chatAPI）
  - AI 回复也自动添加到消息列表（AI 消息）
  - **消息顺序**：AI 回复在用户消息**上方**（最新在上）

**已完成：**
- ✅ 录音 UI（麦克风按钮，录音中状态）
- ✅ 麦克风权限处理
- ✅ 音频录制（MediaRecorder API，WAV 格式转换）
- ✅ 音频上传和识别（ASR API 集成）
- ✅ 错误处理（网络错误、识别失败等）
- ✅ 识别结果填入输入框（当前实现，需要改为即时显示）

---

#### 2.2 对话功能
**当前状态：** ✅ 基础功能已实现  
**需要优化：**

**P0 - 核心功能（已完成）：**
- [x] **聊天布局重构**（舞台剧场模式）：
  - ✅ 前端：只显示最新一条消息（Agent 和 User 各一条），固定高度对话框
  - ✅ 后端：完整消息历史存档（用于 RAG 回溯），已实现
  - ✅ Processing 期间显示上一条消息逻辑

**已完成：**
- ✅ 实时字幕显示（滚动字幕式，不超过三行）
- ✅ 情绪识别和显示（实时更新）
- ✅ 说话人切换（显示用户自定义名字）
- ✅ 音频处理状态切换（RECEIVING → PROCESSING → LINK ACTIVE）

---

#### 2.3 页面流转
**当前状态：** 基础 Tab 切换  
**需要实现：**

**P0 - 核心功能：**
- [ ] Landing Page → 主页面（点击 INITIATE LINK）
- [ ] 主页面 ↔ Memories（点击 MEMORIES 按钮）
- [ ] 主页面 → Capture 弹窗（点击 CAPTURE 按钮）
- [ ] Memories → Moment Card（点击星体）
- [ ] 主页面 → 设置（点击设置按钮）

---

### 三、视觉效果（Visual Effects）

#### 3.1 字体系统
**当前状态：** 默认字体  
**需要实现：**

**P0 - 核心功能：**
- [ ] **科幻字体**：用于标题、按钮、标签
  - 建议：Courier New, Monaco, 或 Google Fonts
  - 应用位置：标题、按钮文字、状态标签
- [ ] **手写字体**：用于名字、情绪、Moment Card
  - 建议：Brush Script, Pacifico, Caveat, Indie Flower
  - 应用位置：输入内容、情绪显示、Moment Card 标题和正文
  - 渐变效果：紫-粉、蓝-紫（用于名字显示）

---

#### 3.2 动画系统
**当前状态：** 无动画  
**需要实现：**

**P0 - 核心功能：**
- [ ] **浮现特效**：Landing Page, Moment Card（fade in + scale，0.5-0.6s）
- [ ] **滚动字幕动画**：从下往上滚动，fade in
- [ ] **按钮 hover 效果**：glow 效果 + scale（1.0 → 1.05）
- [ ] **录音按钮脉冲动画**：录音中黄色发光，脉冲效果
- [ ] **状态切换过渡动画**：平滑过渡（0.3s）

---

#### 3.3 发光效果
**当前状态：** 无发光效果  
**需要实现：**

**P0 - 核心功能：**
- [ ] 标题霓虹发光（CSS text-shadow）
- [ ] 情绪文字发光
- [ ] 按钮发光（hover 状态）

---

#### 3.4 颜色系统
**当前状态：** 基础颜色  
**需要实现：**

**P0 - 核心功能：**
- [ ] **背景**：纯黑色 (#000000)
- [ ] **面板**：深灰色 (#1a1a1a 或 #2a2a2a)
- [ ] **文字**：
  - 科幻字体：白色 (#FFFFFF)
  - 手写字体：白色或渐变（紫-粉、蓝-紫）
- [ ] **情绪颜色映射**：
  - Joy：黄色 (#FFD700)
  - Sadness：蓝色 (#9370DB 或 #4682B4)
  - Anger：红色 (#FF6347)
  - Fear：蓝色 (#4682B4)
  - Love：粉色 (#FF69B4)
  - Surprise：橙色 (#FFA500)
  - Neutral：灰色 (#D3D3D3)
- [ ] **发光效果**：霓虹紫蓝色 (#9370DB, #667eea)

---

### 四、技术实现（Technical Implementation）

#### 4.1 状态管理
**当前状态：** 基础 React state  
**需要优化：**

**P0 - 核心功能：**
- [ ] 全局状态管理（Zustand 或 Context API）
  - userInfo（用户信息：TRAVELER 和 COMPANION 名字）
  - currentMomentId（当前 Moment）
  - messages（对话历史）
  - moments（所有 Moments）
  - audioUrl（当前音频）
  - recordingState（录音状态：idle / recording / processing / success / error）
  - audioStatus（音频处理状态：RECEIVING / PROCESSING / LINK ACTIVE）
  - emotion（当前情绪）
  - lastSpeaker（最近说话人：TRAVELER 或 COMPANION 名字）
  - subtitle（实时字幕）

---

#### 4.2 API 集成
**当前状态：** 基础 API 调用已实现  
**需要优化：**

**P0 - 核心功能：**
- [ ] ASR API 集成（录音上传和识别）
- [ ] 错误处理优化（网络错误、超时、识别失败）
- [ ] Loading 状态管理（每个 API 调用都有 loading 状态）

---

#### 4.3 音频处理
**当前状态：** TTS 播放已实现  
**需要优化：**

**P0 - 核心功能：**
- [ ] TTS 音频自动播放（autoplay）
- [ ] 播放完成事件监听
- [ ] 错误处理（播放失败）
- [ ] ASR 音频格式转换（如果需要）
- [ ] 文件大小限制（10MB）
- [ ] 录音时长限制（60秒）

---

### 五、优化和增强（Optimization & Enhancement）

#### 5.1 比例适配
**当前状态：** 未适配移动端  
**需要实现：**

**P0 - 核心功能：**
- [ ] 调整所有页面为移动端竖屏比例（375x667 或 390x844）
- [ ] 响应式字体大小
- [ ] 响应式间距
- [ ] 响应式按钮大小
- [ ] 确保 5 块信息在移动端不重叠
- [ ] 实时字幕区域适配
- [ ] 三个主按钮适配移动端

---

#### 5.2 性能优化
**当前状态：** 未优化  
**需要实现：**

**P1 - 重要功能：**
- [ ] 代码分割（Code Splitting）
- [ ] 路由懒加载
- [ ] 组件懒加载
- [ ] 3D 场景按需加载
- [ ] 图片懒加载
- [ ] 字体加载优化

---

#### 5.3 BGM 系统
**当前状态：** 未实现  
**需要实现：**

**P1 - 重要功能：**
- [ ] 情绪 → BGM 自动匹配
- [ ] 音乐平滑过渡（Fade In/Out，3秒）
- [ ] Agent 说话时 BGM 音量降低 30%
- [ ] Agent 说完后 BGM 音量恢复
- [ ] 用户控制（BGM 开关、音量滑块）

**技术栈：**
- Howler.js（音频播放）

---

#### 5.4 粒子背景
**当前状态：** 未实现  
**需要实现：**

**P0 - 核心功能（基础版已完成）：**
- [x] **背景选择功能**（3D传送带选择器）：
  - ✅ 3D传送带式背景选择器（点击选择，支持左右滑动浏览）
  - ✅ 动态加载星体素材文件夹下的所有图片（6张预设星图）
  - ✅ 选中的背景用于该 Moment 的对话背景
  - ✅ 背景状态管理（每次登录都选背景，从Memories返回不选背景）
  - ✅ 背景持久化（保存到localStorage，按用户ID隔离）
  - ⏳ 左右滑动选择优化（当前是点击选择，可优化为滑动确认）
  - ⏳ 保存后成为 Memory Card 的封面（待实现）
- [x] **背景图嵌入**：
  - ✅ 将选中的星图背景嵌入到聊天主页面
  - ✅ 背景图作为聊天界面的底层背景
  - ✅ 确保不遮挡状态信息和消息列表

**P1 - 重要功能（基础版已完成，待增强）：**
- [x] Three.js 粒子背景（叠加在背景图上，基础版）
- [x] 粒子交互效果（鼠标/触摸移动粒子）
- ⏳ 粒子颜色随情绪变化（后续实现）
- ⏳ 粒子数量自适应（移动端减少，后续实现）
- ⏳ 粒子波形同步（高级，P2）

**技术栈：**
- Particles.js 或 Three.js
- 背景图：预设星图素材（nebula1.png, nebula2.png, nebula3.png 等）

**设计说明：**
- **简化设计**：用户不需要上传任何自己的图片
- **预设背景**：提供 10 张预设星图供用户选择
- **滑动选择**：左右滑动切换背景，不影响布局

---

#### 5.5 星轨背景素材
**当前状态：** 纯黑背景  
**需要实现：**

**P2 - 增强功能：**
- [ ] 替换 Memories 页面的纯黑背景
- [ ] 整合星轨素材（等你提供素材）

---

#### 5.6 PWA 配置
**当前状态：** 未配置  
**需要实现：**

**P2 - 增强功能：**
- [ ] Manifest.json 配置
- [ ] Service Worker
- [ ] 离线缓存
- [ ] 安装到主屏幕

---

## 🎯 优先级排序（按实现顺序）

### Phase 1: P0 核心功能（必须实现）

**1.1 页面和界面重构**
1. ✅ Landing Page 优化（浮现特效、霓虹发光、手写字体）
2. ✅ 主页面布局重构（三按钮布局 + 5块状态信息）
3. ✅ Capture 弹窗
4. ✅ Moment Card 样式（浮现动画、彩色边框、手写字体）
5. ✅ Memories 星轨图（Canvas 2D 基础版，纯黑背景）
6. ✅ 设置页面优化（手写字体、渐变颜色）

**1.2 交互功能（待完成）**
7. ✅ 语音识别（ASR）集成（录音 UI + 上传 + 识别）
8. ✅ 实时字幕显示（滚动字幕式）
9. ✅ 情绪识别和显示
10. ✅ 说话人显示（用户自定义名字）
11. ✅ 音频处理状态切换
12. ✅ 页面流转逻辑
13. ✅ **聊天布局重构**（P0 - 舞台剧场模式 + 即时显示）
14. ✅ **背景选择功能**（P0 - 3D传送带选择器，基础版已完成）
15. ✅ **粒子背景嵌入**（P0 - Three.js粒子系统，基础版已完成）
16. ⏳ **背景选择优化**（P0 - 左右滑动选择优化，保存为Memory Card封面）
17. ⏳ **粒子背景增强**（P1 - 粒子颜色随情绪变化，移动端优化）

**1.3 Memories 3D 化（P1）**
16. Memories 星轨图 3D 化（参考 memories参考.png，增强空间感）

**1.3 视觉效果**
13. 字体系统（科幻字体 + 手写字体）
14. 动画系统（浮现、滚动、脉冲）
15. 发光效果（霓虹、情绪文字）
16. 颜色系统（情绪颜色映射）

**1.4 技术实现**
17. 状态管理优化（全局状态）
18. API 集成优化（ASR、错误处理）
19. 音频处理优化（TTS、ASR）

**1.5 比例适配**
20. 移动端适配（所有页面）

---

### Phase 2: P1 重要功能（应该实现）

**2.1 视觉效果增强**
21. 粒子背景（基础版）
22. 粒子颜色随情绪变化

**2.2 音频增强**
23. BGM 系统（情绪匹配、淡入淡出、音量控制）

**2.3 性能优化**
24. 代码分割和懒加载
25. 资源优化

---

### Phase 3: P2 增强功能（可选实现）

**3.1 视觉效果增强**
26. 星轨背景素材整合（等你提供）
27. 粒子波形同步（高级）

**3.2 功能增强**
28. PWA 配置
29. 高级动画效果
30. 深色模式切换（可选）

---

## 📊 工作量估算

| Phase | 模块 | 预计时间 |
|-------|------|---------|
| Phase 1 | ✅ Landing Page 优化 | 1h |
| Phase 1 | ✅ 主页面布局重构 | 3h |
| Phase 1 | ✅ Capture 弹窗 | 1h |
| Phase 1 | ✅ Moment Card 样式 | 2h |
| Phase 1 | ✅ Memories 星轨图（2D） | 3h |
| Phase 1 | ✅ 设置页面优化 | 1h |
| Phase 1 | ✅ 语音识别集成 | 2h |
| Phase 1 | ✅ 实时字幕和状态显示 | 2h |
| Phase 1 | ✅ 字体和动画系统 | 2h |
| Phase 1 | ✅ 状态管理和 API 优化 | 2h |
| Phase 1 | ✅ 移动端适配 | 2h |
| Phase 1 | ✅ **聊天布局重构**（舞台剧场模式 + 即时显示） | **已完成** |
| Phase 1 | ✅ **背景选择功能**（3D传送带选择器） | **已完成** |
| Phase 1 | ✅ **粒子背景嵌入**（Three.js粒子系统基础版） | **已完成** |
| Phase 1 | ⏳ **背景选择优化**（滑动选择优化，Memory Card封面） | **1-2h** |
| Phase 1 | ⏳ **粒子背景增强**（情绪颜色变化，移动端优化） | **1-2h** |
| **Phase 1 小计** | | **27-32h** |
| Phase 2 | Memories 星轨图 3D 化 | 6-8h |
| Phase 2 | 粒子背景完整实现 | 2h |
| Phase 2 | BGM 系统 | 2h |
| Phase 2 | 性能优化 | 2h |
| **Phase 2 小计** | | **6h** |
| Phase 3 | 星轨背景素材 | 1h |
| Phase 3 | PWA 配置 | 1h |
| **Phase 3 小计** | | **2h** |
| **总计** | | **29h** |

---

## 📝 关键修正与需求更新

### 聊天布局重构（基于视频参考讨论）
- ✅ **需求确认**：前端采用"舞台剧场模式"，只显示最新一条消息（Agent 和 User 各一条）
- ✅ **后端存档**：完整消息历史存档在 `messages` 数组中，用于 RAG 回溯（已实现）
- ✅ **布局实现**：固定高度对话框、绝对定位输入框、5块状态信息布局
- ✅ **Processing 逻辑**：Processing 期间显示上一条消息，完成后显示最新回复
- ✅ **语音识别即时显示**：识别成功后直接作为用户消息显示，无需文本框确认

### 背景选择功能（简化设计）
- ✅ **不需要**用户上传图片
- ✅ **预设背景**：10 张预设星图（参考 nebula1.png, nebula2.png, nebula3.png）
- ✅ **左右滑动**：选择背景，不影响布局（参考"记忆库碎片化存储2.jpg"）
- ✅ **保存逻辑**：选中的背景成为 Memory Card 的封面

### Memories 3D 化（不需要碎片形式）
- ✅ **需求确认**：不需要参考视频的碎片形式（用户自定义图片上传）
- ✅ **3D 空间感**：在现有星图模式基础上增强 3D 空间感
- ✅ **参考素材**：`memories参考.png` 的单个星体渲染效果
- ✅ **技术实现**：Three.js 或增强 Canvas 2D 的 3D 视觉效果

### 主页面第三层（最近说话人）
- ✅ **修正**：显示用户自定义名字（TRAVELER 名字或 COMPANION 名字）
- ✅ **示例**：显示 "Irene"（TRAVELER）或 "Kay"（COMPANION）

### Moment Card 内容
- ✅ **确认**：包含标题、日期、正文（第一人称叙事）

---

## 🚀 下一步行动

1. **确认需求理解**：请确认以上需求梳理是否完整准确
2. **开始实现**：按 Phase 1 优先级逐步实现
3. **迭代优化**：每完成一个模块进行测试和反馈

---

**文档版本：** v5  
**最后更新：** 2025-01-XX  
**状态：** UI设计优化和1:1复刻参考代码样式

**更新内容：**
- ✅ 更新已完成部分（ASR、布局重构、星轨图、背景选择、粒子背景等）
- ✅ 更新聊天布局需求（消息列表、AI在上、即时显示）
- ✅ 更新背景选择功能状态（3D传送带选择器，基础版已完成）
- ✅ 更新粒子背景状态（Three.js粒子系统，基础版已完成）
- ✅ 更新背景状态管理（sessionChoiceMade + sessionUserId）
- ✅ 更新设置页面状态（重命名功能已完成）
- ✅ 更新优先级和工作量估算
- ✅ **UI设计优化**（2025-01-XX）：
  - ✅ 右侧浮动操作按钮1:1复刻参考代码（图标形式，hover显示文字）
  - ✅ 底部主按钮移除背景填充（透明背景）
  - ✅ Settings按钮图标替换为参考代码中的Settings图标
  - ✅ Echoes页文字样式1:1复刻参考代码（字体、大小、行间距）
