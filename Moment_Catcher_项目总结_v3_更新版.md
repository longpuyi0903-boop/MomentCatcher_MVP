# Moment Catcher - é¡¹ç›®å®Œæ•´æ€»ç»“æ–‡æ¡£ (Day 2 æ›´æ–°)

**æ›´æ–°æ—¥æœŸï¼š** 2025-12-13  
**ç‰ˆæœ¬ï¼š** MVP v3  
**çŠ¶æ€ï¼š** Day 2 å®Œæˆï¼ŒRAG ç³»ç»Ÿå·²é›†æˆ

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [Day 1 å®Œæˆå†…å®¹](#day-1-å®Œæˆå†…å®¹)
3. [Day 2 å®Œæˆå†…å®¹](#day-2-å®Œæˆå†…å®¹-new)
4. [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
5. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
6. [å¼€å‘é˜¶æ®µ](#å¼€å‘é˜¶æ®µ)
7. [Phase 2 å¾…å®ç°åŠŸèƒ½](#phase-2-å¾…å®ç°åŠŸèƒ½)
8. [æ–‡ä»¶ç»“æ„](#æ–‡ä»¶ç»“æ„)
9. [API æˆæœ¬](#api-æˆæœ¬)

---

## é¡¹ç›®æ¦‚è¿°

### æ ¸å¿ƒå®šä½

**Moment Catcher** - æƒ…æ„Ÿé™ªä¼´å‹ AI Agent

- **ä¸æ˜¯ï¼š** âŒ èŠå¤©æœºå™¨äºº âŒ æ—¥è®° App âŒ å¿ƒç†æ²»ç–—å·¥å…·
- **æ˜¯ï¼š** âœ… æƒ…æ„Ÿé™ªä¼´è€… âœ… è®°å¿†æ•æ‰‹ âœ… ç§å¯†æƒ…ç»ªå‡ºå£

### äº§å“ç†å¿µ

ç”¨æˆ·ä¸å®šæœŸè®°å½•æƒ…ç»ªç¬é—´ï¼ŒAI é™ªä¼´è€…ï¼ˆKayï¼‰å€¾å¬ã€å…±æƒ…ã€é™ªä¼´ã€‚æ¯ä¸ª Moment = å¤šè½®å¯¹è¯ â†’ è§†è§‰åŒ– Moment Cardã€‚é•¿æœŸè®°å¿†ï¼ˆRAGï¼‰è®© Agent è¶Šæ¥è¶Šæ‡‚ä½ ã€‚

---

## Day 1 å®Œæˆå†…å®¹

### âœ… å·²å®ç°åŠŸèƒ½

**1. åŸºç¡€å¯¹è¯ç³»ç»Ÿ**
- LLMï¼šé€šä¹‰åƒé—® Qwen-Max
- Personaï¼šKay v5ï¼ˆæ¸©æŸ”é™ªä¼´ + é€‚åº¦è„†å¼±æ„Ÿï¼‰
- å¯¹è¯å†å²ç®¡ç†ï¼ˆUserSessionï¼‰

**2. è¯­éŸ³å…‹éš†**
- TTS å¼•æ“ï¼šé˜¿é‡Œäº‘ CosyVoice v3-plus
- ç”¨æˆ·è‡ªå®šä¹‰å£°éŸ³æ ·æœ¬ï¼ˆ23.62ç§’ï¼‰
- Voice IDï¼š`cosyvoice-v3-plus-companion-xxx`
- è‡ªç„¶åº¦ï¼š95/100ï¼ˆvs 60/100 é¢„è®¾å£°éŸ³ï¼‰

**3. åå­—è‡ªå®šä¹‰**
- ç”¨æˆ·åï¼ˆTraveler IDï¼‰
- Agent åï¼ˆCompanion IDï¼‰
- æŒä¹…åŒ–å­˜å‚¨

**4. Gradio MVP ç•Œé¢**
- å¯¹è¯ç•Œé¢
- å®æ—¶è¯­éŸ³æ’­æ”¾
- åŸºç¡€äº¤äº’é€»è¾‘

---

## Day 2 å®Œæˆå†…å®¹ ğŸ†•

### âœ… RAG è®°å¿†ç³»ç»Ÿ

**1. Moment ä¼šè¯ç®¡ç†**

```python
class MomentManager:
    - åˆ›å»ºæ–° Moment
    - æ·»åŠ å¯¹è¯æ¶ˆæ¯
    - ä¿å­˜ Moment
    - åŠ è½½å†å² Moments
    - å¤šç”¨æˆ·æ•°æ®éš”ç¦» ğŸ†•
```

**ç‰¹æ€§ï¼š**
- æ¯ä¸ª Moment = å®Œæ•´æƒ…æ„Ÿè®°å½•ï¼ˆ5-10 è½®å¯¹è¯ï¼‰
- JSON æ ¼å¼å­˜å‚¨
- æŒ‰ç”¨æˆ·åˆ†æ–‡ä»¶å¤¹éš”ç¦»

**2. Moment Card ç”Ÿæˆ**

```python
generate_moment_card():
    - ç¬¬ä¸€äººç§°å™äº‹æ€»ç»“ï¼ˆ60-100 å­—ï¼‰
    - æƒ…ç»ªæ ‡ç­¾ï¼ˆjoy/sadness/anger/fear/love/surprise/neutralï¼‰
    - ä¸­æ–‡æ ‡é¢˜ï¼ˆ4-8 å­—ï¼Œå£è¯­åŒ–ï¼‰
    - æƒ…ç»ªé¢œè‰²æ˜ å°„
```

**ä¼˜åŒ–äº®ç‚¹ï¼š**
- âœ… æ ‡é¢˜å’Œæ­£æ–‡è¯­è¨€ä¸€è‡´ï¼ˆä¸­æ–‡ï¼‰
- âœ… å£è¯­åŒ–ä½†ä¸ç”¨ç½‘ç»œçƒ‚æ¢—
- âœ… çº¯ç¬¬ä¸€äººç§°ï¼Œä¸æ"å¯¹æ–¹"ã€"æœ‹å‹"ã€"Ta"
- âœ… åƒå†…å¿ƒç‹¬ç™½ï¼Œä¸åƒå¯¹è¯æ€»ç»“

**ç¦ç”¨è¯æ±‡ï¼š**
- ä¹¦é¢è¯­ï¼šå……æ»¡ã€é¼“èµ·å‹‡æ°”ã€ä¾æ—§ã€è™½ç„¶...ä½†æ˜¯
- ç½‘ç»œè¯­ï¼šå‹åŠ›å±±å¤§ã€å¿ƒæ€å´©äº†ã€emoã€ç ´é˜²
- ä¸æåŠï¼šå¯¹æ–¹ã€æœ‹å‹ã€Taã€èŠå¤©ã€äº¤æµ

**3. Style RAGï¼ˆé£æ ¼å­¦ä¹ ï¼‰**

```python
class StyleRAG:
    - ç»Ÿè®¡å¸¸ç”¨è¯æ±‡
    - åˆ†æå¥å­é•¿åº¦
    - æ£€æµ‹ä¸­è‹±æ··åˆç¨‹åº¦
    - è¯†åˆ« emoji ä½¿ç”¨ä¹ æƒ¯
    - æå–å¸¸ç”¨çŸ­è¯­
    - å¤šç”¨æˆ·æ•°æ®éš”ç¦» ğŸ†•
```

**åŠŸèƒ½ï¼š**
- Agent é€æ¸æ¨¡ä»¿ç”¨æˆ·è¯´è¯é£æ ¼
- è‡ªé€‚åº”å¥é•¿ã€è¯­æ°”ã€emoji
- æŒä¹…åŒ–å­¦ä¹ æ•°æ®

**4. Context RAGï¼ˆä¸Šä¸‹æ–‡æ£€ç´¢ï¼‰**

```python
class ContextRAG:
    - å…³é”®è¯åŒ¹é…æ£€ç´¢
    - æ—¶é—´èŒƒå›´æ£€ç´¢
    - æƒ…ç»ªè¿‡æ»¤æ£€ç´¢
    - ç”Ÿæˆä¸Šä¸‹æ–‡æç¤º
```

**åŠŸèƒ½ï¼š**
- ä»å†å² Moments ä¸­æ£€ç´¢ç›¸å…³å†…å®¹
- æ³¨å…¥åˆ° LLM prompt
- Agent èƒ½ recall å†å²å¯¹è¯

**æµ‹è¯•åœºæ™¯ï¼š**
```
Moment 1: "æˆ‘æœ‰ä¸ªå¾ˆéš¾çš„ projectï¼Œä¸çŸ¥é“èƒ½ä¸èƒ½åšæˆ"
Moment 5: "Finallyï¼æˆ‘åšæˆäº†ä¹‹å‰é‚£ä¸ª projectï¼"
æœŸå¾…ï¼šAgent èƒ½ recall Moment 1 å†…å®¹
```

### âœ… Landing Page

**è®¾è®¡ï¼š**
- æ ‡é¢˜ï¼š**MOMENT CATCHER**
- è¾“å…¥æ¡†ï¼šTRAVELER ID / COMPANION ID
- æŒ‰é’®ï¼šINITIATE LINK
- é£æ ¼ï¼šç§‘å¹»æ·±ç©ºé»‘ + æ¸å˜ç‰¹æ•ˆ

**åŠŸèƒ½ï¼š**
- åå­—æŒä¹…åŒ–å­˜å‚¨
- è‡ªåŠ¨å¡«å……ï¼ˆä¸‹æ¬¡å¯åŠ¨ï¼‰
- è¿›å…¥ä¸»ç•Œé¢

### âœ… å¤šç”¨æˆ·æ•°æ®éš”ç¦» ğŸ†•

**ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼š**
```
ç”¨æˆ· ID = ç”¨æˆ·å_Agentå
ä¾‹å¦‚ï¼š
- Ace + Yvonne = "Ace_Yvonne"
- Bobby + Yvonne = "Bobby_Yvonne"
```

**æ•°æ®éš”ç¦»ï¼š**
```
storage/
â”œâ”€â”€ moments/
â”‚   â”œâ”€â”€ Ace_Yvonne/
â”‚   â”‚   â”œâ”€â”€ moment_xxx.json
â”‚   â”‚   â””â”€â”€ moment_yyy.json
â”‚   â””â”€â”€ Bobby_Yvonne/
â”‚       â”œâ”€â”€ moment_aaa.json
â”‚       â””â”€â”€ moment_bbb.json
â””â”€â”€ user_data/
    â”œâ”€â”€ Ace_Yvonne_style.json
    â”œâ”€â”€ Bobby_Yvonne_style.json
    â””â”€â”€ names.json
```

**æ•ˆæœï¼š**
- âœ… ä¸åŒç”¨æˆ·çš„ Moments å®Œå…¨éš”ç¦»
- âœ… é£æ ¼å­¦ä¹ ç‹¬ç«‹
- âœ… æ”¯æŒå¤šäººä½¿ç”¨åŒä¸€åº”ç”¨

### âœ… Gradio ç•Œé¢ä¼˜åŒ–

**Tab 1: ğŸ’¬ å¯¹è¯**
- çŠ¶æ€æ ï¼ˆå®æ—¶æç¤ºï¼‰
- å¯¹è¯å†å²ï¼ˆèŠå¤©æ¡†ï¼‰
- æ–‡å­—è¾“å…¥ + è¯­éŸ³æ’­æ”¾
- æŒ‰é’®ï¼šå¼€å§‹æ–° Moment / ä¿å­˜ Moment

**Tab 2: ğŸ“š Memories**
- æ‰€æœ‰ Moments åˆ—è¡¨
- æ˜¾ç¤ºï¼šæ—¥æœŸã€æƒ…ç»ªã€æ ‡é¢˜ã€æ€»ç»“ã€æ¶ˆæ¯æ•°
- åˆ·æ–°æŒ‰é’®

**Tab 3: âš™ï¸ è®¾ç½®**
- ä¿®æ”¹åå­—
- æŸ¥çœ‹é£æ ¼ç”»åƒ

---

## æ ¸å¿ƒåŠŸèƒ½

### Agent Persona (Kay v5)

**æ ¸å¿ƒç‰¹è´¨ï¼š**
1. **Companionshipï¼ˆé™ªä¼´æ„Ÿï¼‰** - "we" not "you should"
2. **Vulnerabilityï¼ˆè„†å¼±æ„Ÿï¼‰** - æ‰¿è®¤ä¸æ‡‚ã€ä¸ç¡®å®šã€ä¼šç´¯
3. **Empathyï¼ˆå…±æƒ…ï¼‰** - ç†è§£æƒ…ç»ªä¼˜å…ˆï¼Œä¸ç»™å»ºè®®
4. **Naturalï¼ˆè‡ªç„¶ï¼‰** - å£è¯­åŒ–ã€æ··åˆä¸­è‹±ã€ç®€æ´

**è„†å¼±æ„Ÿé¢‘ç‡ï¼š**
- 90% æ­£å¸¸é™ªä¼´
- 10% å±•ç°è„†å¼±ï¼ˆæ·±å¤œ/å¤æ‚é—®é¢˜/ç”¨æˆ·æƒ…ç»ªä½è½æ—¶ï¼‰

**ç¦ç”¨è¡¨è¾¾ï¼š**
- AI è…”ï¼šCEO å¤§è„‘ã€åŒä»½å¤§å–œè®¯ã€å°å­˜è“„èƒ½ã€ä½ å€¼å¾—
- ç¿»è¯‘è…”ï¼šå¬èµ·æ¥ã€æ„Ÿè§‰ã€ä¼¼ä¹ã€åŒé‡å¤¹å‡»
- å®¢æœè…”ï¼šå»ºè®®ä½ ã€ä½ å¯ä»¥è¯•è¯•ã€ä¸å¦‚ã€è¦ä¸è¦

### Moment æ•°æ®ç»“æ„

```json
{
  "moment_id": "moment_xxx",
  "timestamp": "2025-12-13 10:30",
  "messages": [
    {"role": "user", "content": "...", "emotion": "neutral"},
    {"role": "assistant", "content": "...", "emotion": "neutral"}
  ],
  "summary": "æˆ‘æ„Ÿåˆ°...",
  "emotion_tag": "joy",
  "title": "ç»ˆäºåšå®Œäº†",
  "color": "#FFD700",
  "card_generated": true,
  "message_count": 6
}
```

### Moment Card ç”Ÿæˆæµç¨‹

```
å¯¹è¯æ¶ˆæ¯ â†’ LLM åˆ†æ
    â†“
1. æ£€æµ‹ä¸»å¯¼æƒ…ç»ªï¼ˆjoy/sadness/anger/fear/love/surprise/neutralï¼‰
2. ç”Ÿæˆç¬¬ä¸€äººç§°å™äº‹ï¼ˆ60-100 å­—ï¼Œçº¯ç¬¬ä¸€äººç§°å†…å¿ƒç‹¬ç™½ï¼‰
3. ç”Ÿæˆä¸­æ–‡æ ‡é¢˜ï¼ˆ4-8 å­—ï¼Œå£è¯­åŒ–ï¼Œä¸ç”¨çƒ‚æ¢—ï¼‰
4. æ˜ å°„æƒ…ç»ªé¢œè‰²
    â†“
Moment Cardï¼ˆæ—¥æœŸ + æƒ…ç»ª + æ ‡é¢˜ + æ€»ç»“ï¼‰
```

### æƒ…ç»ªé¢œè‰²æ˜ å°„

```python
EMOTION_COLORS = {
    "joy": "#FFD700",       # é»„è‰²
    "sadness": "#9370DB",   # ç´«è‰²
    "anger": "#FF6347",     # çº¢è‰²
    "fear": "#4682B4",      # è“è‰²
    "love": "#FF69B4",      # ç²‰è‰²
    "surprise": "#FFA500",  # æ©™è‰²
    "neutral": "#D3D3D3"    # ç°è‰²
}
```

---

## æŠ€æœ¯æ¶æ„

### å½“å‰æŠ€æœ¯æ ˆï¼ˆGradio MVPï¼‰

**å‰ç«¯ï¼š**
- Gradioï¼ˆå¿«é€ŸåŸå‹ï¼‰
- è‡ªå®šä¹‰ CSSï¼ˆç§‘å¹»é£æ ¼ï¼‰

**åç«¯ï¼š**
- Python 3.11
- FastAPIï¼ˆæœªæ¥ï¼‰

**AI æœåŠ¡ï¼š**
- LLMï¼šé€šä¹‰åƒé—® Qwen-Maxï¼ˆé˜¿é‡Œäº‘ DashScopeï¼‰
- TTSï¼šCosyVoice v3-plusï¼ˆvoice cloningï¼‰
- ASRï¼šé˜¿é‡Œäº‘ DashScopeï¼ˆå‡†å¤‡ä¸­ï¼ŒPhase 2ï¼‰

**å­˜å‚¨ï¼š**
- JSON æ–‡ä»¶ï¼ˆä¸´æ—¶æ–¹æ¡ˆï¼‰
- å¤šç”¨æˆ·æ•°æ®éš”ç¦»ï¼ˆæ–‡ä»¶å¤¹åˆ†ç¦»ï¼‰

**RAGï¼š**
- Style RAGï¼ˆç®€å•ç»Ÿè®¡ï¼‰
- Context RAGï¼ˆå…³é”®è¯åŒ¹é…ï¼‰
- å‘é‡æ•°æ®åº“ï¼šæœªä½¿ç”¨ï¼ˆPhase 2 è€ƒè™‘ Chromaï¼‰

### æ–‡ä»¶ç»“æ„

```
MomentCatcher_MVP/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ agent/
â”‚   â”‚   â””â”€â”€ reply_generator.py      # LLM å›å¤ç”Ÿæˆ
â”‚   â”œâ”€â”€ audio/
â”‚   â”‚   â”œâ”€â”€ tts_engine.py           # CosyVoice TTSï¼ˆå…‹éš†å£°éŸ³ï¼‰
â”‚   â”‚   â””â”€â”€ asr_engine.py           # ASRï¼ˆå‡†å¤‡ä¸­ï¼‰
â”‚   â””â”€â”€ memory/                     # RAG æ ¸å¿ƒ ğŸ†•
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ moment_manager.py       # Moment ç®¡ç†ï¼ˆå¤šç”¨æˆ·ï¼‰
â”‚       â”œâ”€â”€ moment_card.py          # Moment Card ç”Ÿæˆ
â”‚       â”œâ”€â”€ style_rag.py            # é£æ ¼å­¦ä¹ ï¼ˆå¤šç”¨æˆ·ï¼‰
â”‚       â””â”€â”€ context_rag.py          # ä¸Šä¸‹æ–‡æ£€ç´¢
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ persona_config.py           # Kay v5 persona
â”‚   â””â”€â”€ emotion_color_map.py        # æƒ…ç»ªé¢œè‰²æ˜ å°„
â”œâ”€â”€ data_model/
â”‚   â””â”€â”€ user_session.py             # ç”¨æˆ·ä¼šè¯æ¨¡å‹
â”œâ”€â”€ storage/                        # æ•°æ®å­˜å‚¨ ğŸ†•
â”‚   â”œâ”€â”€ moments/                    # æŒ‰ç”¨æˆ·åˆ†æ–‡ä»¶å¤¹
â”‚   â”‚   â”œâ”€â”€ Ace_Yvonne/
â”‚   â”‚   â””â”€â”€ Bobby_Yvonne/
â”‚   â””â”€â”€ user_data/
â”‚       â”œâ”€â”€ Ace_Yvonne_style.json
â”‚       â”œâ”€â”€ Bobby_Yvonne_style.json
â”‚       â””â”€â”€ names.json
â”œâ”€â”€ audio_outputs/
â”‚   â””â”€â”€ latest_reply.wav            # TTS è¾“å‡º
â”œâ”€â”€ audio_samples/
â”‚   â””â”€â”€ companion_voice.m4a         # å£°éŸ³å…‹éš†æ ·æœ¬
â”œâ”€â”€ gradio_app.py                   # ä¸»åº”ç”¨ï¼ˆv3ï¼Œå¸¦ Landing Pageï¼‰
â”œâ”€â”€ .env                            # API Keys
â””â”€â”€ requirements.txt
```

---

## å¼€å‘é˜¶æ®µ

### Phase 1: Gradio MVPï¼ˆDays 1-4ï¼‰âœ… Day 2 å®Œæˆ

**Day 1 å®Œæˆï¼š**
- âœ… å¯¹è¯ç³»ç»Ÿï¼ˆ100%ï¼‰
- âœ… åå­—è‡ªå®šä¹‰ï¼ˆ100%ï¼‰
- âœ… TTS è¯­éŸ³å…‹éš†ï¼ˆ100%ï¼‰
- âœ… Agent persona v5ï¼ˆ95%ï¼‰

**Day 2 å®Œæˆï¼š** ğŸ†•
- âœ… RAG è®°å¿†ç³»ç»Ÿï¼ˆ100%ï¼‰
  - Moment Managerï¼ˆå¤šç”¨æˆ·æ”¯æŒï¼‰
  - Moment Card ç”Ÿæˆï¼ˆä¼˜åŒ– promptï¼‰
  - Style RAGï¼ˆé£æ ¼å­¦ä¹ ï¼‰
  - Context RAGï¼ˆä¸Šä¸‹æ–‡æ£€ç´¢ï¼‰
- âœ… Landing Pageï¼ˆMOMENT CATCHERï¼‰
- âœ… Gradio ç•Œé¢ï¼ˆ3 Tabsï¼‰
- âœ… å¤šç”¨æˆ·æ•°æ®éš”ç¦»

**Day 3-4 è®¡åˆ’ï¼š**
- â³ å¤š Moment ç«¯åˆ°ç«¯æµ‹è¯•
- â³ Context RAG recall éªŒè¯
- â³ Style RAG é£æ ¼æ¨¡ä»¿éªŒè¯
- â³ Bug ä¿®å¤å’Œä¼˜åŒ–

### Phase 2: å‰ç«¯é‡æ„ï¼ˆDays 5-8ï¼‰

**ç›®æ ‡ï¼š** å®ç°å®Œæ•´ UI/UX è®¾è®¡ï¼ˆä» Gradio â†’ Reactï¼‰

**æŠ€æœ¯æ ˆï¼š**
- å‰ç«¯ï¼šReact 18 + Vite
- 3Dï¼šThree.jsï¼ˆMemory Nebulaï¼‰
- åŠ¨ç”»ï¼šFramer Motion
- éŸ³é¢‘ï¼šHowler.js
- éƒ¨ç½²ï¼šVercel (frontend) + Railway (backend)

**åŠŸèƒ½ï¼š**
1. **Landing Page**
   - âœ… Three.js è¡Œæ˜ŸåŠ¨ç”»
   - âœ… æµ®ç°ç‰¹æ•ˆ
   - âœ… ç§‘å¹»å­—ä½“

2. **ä¸»ç•Œé¢ï¼ˆ3 æŒ‰é’®ï¼‰**
   - âœ… å·¦ï¼šMemoriesï¼ˆMemory Nebulaï¼‰
   - âœ… ä¸­ï¼šConversationï¼ˆéº¦å…‹é£ï¼‰
   - âœ… å³ï¼šCaptureï¼ˆä¿å­˜ Momentï¼‰

3. **è¯­éŸ³äº¤äº’**
   - âœ… éº¦å…‹é£å½•éŸ³ï¼ˆASRï¼‰
   - âœ… å®æ—¶å­—å¹•ï¼ˆæ»šåŠ¨ï¼Œæœ€å¤š 3 è¡Œï¼‰
   - âœ… å¤„ç†çŠ¶æ€åŠ¨ç”»

4. **Moment Card**
   - âœ… æ‰‹å†™å­—ä½“æ•ˆæœ
   - âœ… å·¦ä¾§æƒ…ç»ªè‰²è¾¹æ¡†
   - âœ… åŠ¨ç”»è¿‡æ¸¡

5. **Memory Nebulaï¼ˆæ˜Ÿç©ºï¼‰**
   - âœ… 3D æ˜Ÿå›¾ï¼ˆThree.jsï¼‰
   - âœ… é¢œè‰² = æƒ…ç»ª
   - âœ… è·ç¦» = æ—¶é—´
   - âœ… ç‚¹å‡»æ˜Ÿæ˜Ÿ â†’ Moment Card å¼¹çª—

### Phase 3: PWA éƒ¨ç½²ï¼ˆDay 9ï¼‰

**åŠŸèƒ½ï¼š**
- PWA é…ç½®
- Service Worker
- ç¦»çº¿ç¼“å­˜
- å®‰è£…åˆ°ä¸»å±å¹•

---

## Phase 2 å¾…å®ç°åŠŸèƒ½

### ğŸ”§ Gradio é™åˆ¶ï¼ˆPhase 2 è§£å†³ï¼‰

**1. è·¨ Tab è‡ªåŠ¨æ›´æ–°**
- **é—®é¢˜ï¼š** Gradio ä¸æ”¯æŒè·¨ Tab ç»„ä»¶å®æ—¶æ›´æ–°
- **ç°çŠ¶ï¼š** ä¿å­˜ Moment åéœ€æ‰‹åŠ¨åˆ‡æ¢åˆ° Memories Tab å¹¶ç‚¹å‡»åˆ·æ–°
- **Phase 2ï¼š** React çŠ¶æ€ç®¡ç†ï¼Œä¿å­˜å Memories åˆ—è¡¨ç«‹å³æ›´æ–°

**2. TTS æƒ…ç»ªè‡ªé€‚åº”**
- **é—®é¢˜ï¼š** é˜¿é‡Œäº‘ CosyVoice ä¸æ”¯æŒæƒ…ç»ªå‚æ•°
- **ç°çŠ¶ï¼š** å›ºå®šå£°éŸ³ï¼Œæ— æ³•æ ¹æ®æƒ…ç»ªè°ƒæ•´è¯­æ°”
- **Phase 2 é€‰é¡¹ï¼š**
  - æ–¹æ¡ˆ Aï¼šåˆ‡æ¢åˆ°æ”¯æŒæƒ…ç»ªçš„ TTSï¼ˆAzure TTS, ElevenLabsï¼‰
  - æ–¹æ¡ˆ Bï¼šä½¿ç”¨ Sambert + emotion å‚æ•°ï¼ˆéå…‹éš†å£°éŸ³ï¼‰
  - æ–¹æ¡ˆ Cï¼šç­‰é˜¿é‡Œäº‘æ›´æ–°

**3. å¤æ‚åŠ¨ç”»æ•ˆæœ**
- **é—®é¢˜ï¼š** Gradio CSS å®šåˆ¶èƒ½åŠ›æœ‰é™
- **ç°çŠ¶ï¼š** Landing Page æ— æµ®ç°ç‰¹æ•ˆã€æ— å¤æ‚åŠ¨ç”»
- **Phase 2ï¼š** Framer Motion å®ç°å®Œæ•´åŠ¨ç”»

**4. å®æ—¶å­—å¹• + ASR**
- **é—®é¢˜ï¼š** Gradio æ–‡å­—è¾“å…¥ä¸ºä¸»ï¼Œè¯­éŸ³å½•åˆ¶æ”¯æŒæœ‰é™
- **ç°çŠ¶ï¼š** ä»…æ–‡å­—å¯¹è¯ï¼Œæ— å®æ—¶è¯­éŸ³è¯†åˆ«
- **Phase 2ï¼š** éº¦å…‹é£å½•éŸ³ + ASR + å®æ—¶å­—å¹•æ»šåŠ¨

**5. 3D Memory Nebula**
- **é—®é¢˜ï¼š** Gradio æ—  3D æ¸²æŸ“èƒ½åŠ›
- **ç°çŠ¶ï¼š** ä»…æ–‡å­—åˆ—è¡¨æ˜¾ç¤º Memories
- **Phase 2ï¼š** Three.js æ˜Ÿç©º 3D å¯è§†åŒ–

---

## API æˆæœ¬

### æœˆåº¦æˆæœ¬ä¼°ç®—ï¼ˆå•ç”¨æˆ·ï¼‰

**ä½¿ç”¨åœºæ™¯ï¼š** æ¯å¤© 10 ä¸ª Momentsï¼Œæ¯ä¸ª Moment 5 è½®å¯¹è¯

| æœåŠ¡ | ç”¨é‡ | å•ä»· | æœˆæˆæœ¬ |
|------|------|------|--------|
| Qwen-Maxï¼ˆLLMï¼‰| ~300 æ¬¡è°ƒç”¨ | Â¥0.12/åƒ tokens | Â¥30-50 |
| CosyVoiceï¼ˆTTSï¼‰| ~300 æ¬¡ | Â¥0.08/åƒå­—ç¬¦ | Â¥20-30 |
| ASRï¼ˆè¯­éŸ³è¯†åˆ«ï¼‰| ~300 æ¬¡ | Â¥0.05/åˆ†é’Ÿ | Â¥10-15 |
| **æ€»è®¡** | - | - | **Â¥60-95** |

**å…è´¹é¢åº¦ï¼ˆé˜¿é‡Œäº‘æ–°ç”¨æˆ·ï¼‰ï¼š**
- DashScope APIï¼šå‰ 100 ä¸‡ tokens å…è´¹
- CosyVoiceï¼šå‰ 100 ä¸‡å­—ç¬¦å…è´¹
- OSS å­˜å‚¨ï¼š40GB/æœˆ å…è´¹ï¼ˆ6 ä¸ªæœˆï¼‰

---

## å…³é”®æŠ€æœ¯å†³ç­–

### 1. Voice Cloning vs é¢„è®¾å£°éŸ³
- **å†³ç­–ï¼š** Voice Cloning âœ…
- **ç†ç”±ï¼š** è‡ªç„¶åº¦ 60/100 â†’ 95/100ï¼Œæƒ…æ„Ÿè¡¨è¾¾åŠ›å¼º
- **æˆæœ¬ï¼š** ç•¥é«˜ä½†å¯æ¥å—

### 2. RAG vs ç®€å•å­˜å‚¨
- **å†³ç­–ï¼š** Full RAG âœ…
- **ç†ç”±ï¼š** æ ¸å¿ƒç«äº‰åŠ›ï¼Œé•¿æœŸé™ªä¼´å¿…å¤‡
- **å®ç°ï¼š** Style RAG + Context RAG

### 3. Gradio vs Custom Frontend
- **å†³ç­–ï¼š** åˆ†é˜¶æ®µ
- **Phase 1ï¼š** Gradioï¼ˆå¿«é€ŸéªŒè¯åŠŸèƒ½ï¼‰
- **Phase 2ï¼š** Reactï¼ˆå®Œæ•´ä½“éªŒï¼‰
- **ç†ç”±ï¼š** å¿«é€ŸåŸå‹ + å®Œæ•´æ§åˆ¶ï¼Œåç«¯å¯å¤ç”¨

### 4. å¤šç”¨æˆ·æ•°æ®éš”ç¦»
- **å†³ç­–ï¼š** ç”¨æˆ·å + Agent å = å”¯ä¸€ ID âœ…
- **ç†ç”±ï¼š** ç®€å•æœ‰æ•ˆï¼Œæ”¯æŒå¤šäººä½¿ç”¨åŒä¸€åº”ç”¨
- **å®ç°ï¼š** æ–‡ä»¶å¤¹åˆ†ç¦»ï¼ˆä¸´æ—¶ï¼‰ï¼ŒPhase 2 è¿ç§»æ•°æ®åº“

---

## æµ‹è¯•è®¡åˆ’

### RAG æµ‹è¯•åœºæ™¯

**Scenario 1: Style Learning**
```
Moments 1-3: ç”¨æˆ·ä½¿ç”¨ä¸­è‹±æ··åˆ + å£è¯­åŒ–
Expected: Moment 4 Agent å›å¤æ¨¡ä»¿ç”¨æˆ·é£æ ¼
```

**Scenario 2: Context Recall**
```
Moment 1: "æˆ‘æœ‰ä¸ªå¾ˆéš¾çš„ project"
Moment 5: "æˆ‘åšæˆäº†é‚£ä¸ª project"
Expected: Agent recall Moment 1 å†…å®¹
```

**Scenario 3: Emotion Continuity**
```
Moment 1: Sadnessï¼ˆå…³äº projectï¼‰
Moment 2: Joyï¼ˆåŒä¸€ projectï¼‰
Expected: Agent æ³¨æ„åˆ°æƒ…ç»ªè½¬å˜
```

---

## æ ¸å¿ƒä»·å€¼ä¸»å¼ 

### ä¸ºä»€ä¹ˆ Moment Catcher ä¸åŒï¼Ÿ

1. **ä¸æ˜¯èŠå¤©å·¥å…·**
   - ç²¾å¿ƒæ•æ‰çš„ç¬é—´ï¼Œä¸æ˜¯æ— å°½å¯¹è¯
   - è´¨é‡ > æ•°é‡

2. **çœŸå®é™ªä¼´**
   - Agent æœ‰è®°å¿†ï¼ˆRAGï¼‰
   - éšæ—¶é—´å­¦ä¹ å’Œæˆé•¿
   - å±•ç°è„†å¼±æ„Ÿï¼ˆä¸å®Œç¾ = çœŸå®ï¼‰

3. **æƒ…ç»ªå¯è§†åŒ–**
   - Moment Cardsï¼ˆç¾å­¦å‘ˆç°ï¼‰
   - Memory Nebulaï¼ˆæ—¶é—´æ—…è¡Œï¼‰
   - é¢œè‰² + æ˜Ÿç©ºï¼ˆè¯—æ„åŒ–ï¼‰

4. **éšç§ç¬¬ä¸€**
   - æœ¬åœ°å­˜å‚¨ï¼ˆæœªæ¥å¯é€‰äº‘ç«¯ï¼‰
   - ç”¨æˆ·æ§åˆ¶æ•°æ®
   - æ— è¯„åˆ¤ã€æ— æ³„éœ²

---

## é™„å½•

### é‡è¦æ–‡ä»¶æ¸…å•

**æ ¸å¿ƒä»£ç ï¼š**
1. `gradio_app.py` - ä¸»åº”ç”¨ï¼ˆv3ï¼ŒLanding Page + å¤šç”¨æˆ·ï¼‰
2. `backend/memory/moment_manager.py` - Moment ç®¡ç†ï¼ˆå¤šç”¨æˆ·éš”ç¦»ï¼‰
3. `backend/memory/moment_card.py` - Moment Card ç”Ÿæˆï¼ˆä¼˜åŒ– promptï¼‰
4. `backend/memory/style_rag.py` - é£æ ¼å­¦ä¹ ï¼ˆå¤šç”¨æˆ·éš”ç¦»ï¼‰
5. `backend/memory/context_rag.py` - ä¸Šä¸‹æ–‡æ£€ç´¢
6. `backend/agent/reply_generator.py` - LLM å›å¤ç”Ÿæˆ
7. `backend/audio/tts_engine.py` - TTSï¼ˆvoice cloningï¼‰
8. `config/persona_config.py` - Kay v5 persona

**é…ç½®æ–‡ä»¶ï¼š**
- `.env` - API Keys
- `requirements.txt` - Python ä¾èµ–
- `storage/user_data/names.json` - ç”¨æˆ·åå­—æŒä¹…åŒ–

**æ•°æ®å­˜å‚¨ï¼š**
- `storage/moments/{user_id}/` - ç”¨æˆ· Moments
- `storage/user_data/{user_id}_style.json` - ç”¨æˆ·é£æ ¼æ•°æ®

---

## ä¸‹ä¸€æ­¥è®¡åˆ’

### Day 3ï¼ˆæ˜å¤©ï¼‰

**æµ‹è¯•é‡ç‚¹ï¼š**
1. åˆ›å»º 5+ Momentsï¼ˆä¸åŒè¯é¢˜ï¼‰
2. éªŒè¯ Context RAG recall èƒ½åŠ›
3. éªŒè¯ Style RAG é£æ ¼æ¨¡ä»¿
4. Bug ä¿®å¤

**ä¼˜åŒ–ï¼š**
1. Moment Card è´¨é‡è¯„ä¼°
2. Agent å›å¤è‡ªç„¶åº¦ä¼˜åŒ–
3. RAG æ£€ç´¢å‡†ç¡®æ€§è°ƒä¼˜

### Day 4

**æ”¶å°¾ï¼š**
1. Gradio MVP æœ€ç»ˆä¼˜åŒ–
2. å®Œæ•´åŠŸèƒ½æ¼”ç¤º
3. å‡†å¤‡ Phase 2 å‰ç«¯é‡æ„

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v3 (Day 2 æ›´æ–°)  
**æœ€åæ›´æ–°ï¼š** 2025-12-13  
**çŠ¶æ€ï¼š** RAG ç³»ç»Ÿå·²é›†æˆï¼Œå¤šç”¨æˆ·éš”ç¦»å·²å®ç°
