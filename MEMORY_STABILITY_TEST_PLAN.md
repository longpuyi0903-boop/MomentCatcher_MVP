# 记忆系统稳定性测试计划

**目标**：通过多轮测试验证记忆系统稳定性，每轮测试后根据反馈快速修复

**测试策略**：今天连续多轮测试，每轮不同场景，按反馈迭代改进

---

## 📋 测试轮次规划

### Round 1: 基础跨Moment记忆（简单）
**目标**：验证基本的跨Moment记忆检索

**测试场景**：
1. Moment 1: 用户说"我养了一只叫'豆包'的柴犬"
2. Moment 2: 用户说"今天天气不错"
3. Moment 3: 用户问"你还记得我的狗叫什么名字吗？"

**预期结果**：Agent 应该回答"豆包"

**检查点**：
- ✅ 是否正确检索到"豆包"
- ✅ 是否准确说出名字（不是"那只狗"）
- ✅ 是否引用了相关上下文

---

### Round 2: 复杂事实记忆（中等）
**目标**：验证多个细节的记忆

**测试场景**：
1. Moment 1: "昨天下午3点，我在星巴克买了一杯焦糖玛奇朵，店员把我的名字'小雨'写成了'小宇'，我纠正了三次"
2. Moment 2: 其他话题
3. Moment 3: 用户问"你还记得我昨天在星巴克买的咖啡是什么吗？店员写错了什么？"

**预期结果**：
- 咖啡：焦糖玛奇朵
- 时间：下午3点（可选）
- 名字错误：'小雨'→'小宇'
- 纠正次数：三次

**检查点**：
- ✅ 所有细节是否准确
- ✅ 是否有遗漏或错误

---

### Round 3: 未提及内容（防编造）
**目标**：确保不会编造未提及的内容

**测试场景**：
1. Moment 1-3: 正常对话，不涉及衣服
2. Moment 4: 用户问"你还记得我昨天穿的是什么颜色的衣服吗？"

**预期结果**：Agent 应该明确承认不记得，不能编造

**检查点**：
- ✅ 是否承认不记得
- ❌ 是否编造了颜色
- ❌ 是否用模糊词逃避（"好像"、"可能"）

---

### Round 4: 时间范围记忆（复杂）
**目标**：验证时间相关的记忆检索

**测试场景**：
1. Moment 1: "上周二早上5点多，我用蓝色保温杯喝咖啡"
2. Moment 2: "昨天中午12点，我在公司吃了午饭"
3. Moment 3: 用户问"我一般是哪天、几点左右起床的？"

**预期结果**：应该回答"周二早上五点多"（或类似）

**检查点**：
- ✅ 是否正确识别时间
- ✅ 是否混淆了不同时间点

---

### Round 5: 相似内容区分（困难）
**目标**：验证能区分相似但不同的内容

**测试场景**：
1. Moment 1: "我喜欢喝拿铁"
2. Moment 2: "我朋友喜欢喝卡布奇诺"
3. Moment 3: 用户问"你还记得我喜欢喝什么咖啡吗？"

**预期结果**：应该回答"拿铁"，不能混淆成"卡布奇诺"

**检查点**：
- ✅ 是否区分了"我"和"朋友"
- ❌ 是否混淆了不同人的偏好

---

### Round 6: 多条件查询（困难）
**目标**：验证复杂查询的记忆检索

**测试场景**：
1. Moment 1: "我在武康路的一家咖啡店遇到了周楠，他迟到了20分钟"
2. Moment 2: 其他话题
3. Moment 3: 用户问"你还记得我在哪里遇到周楠的吗？他迟到了多久？"

**预期结果**：
- 地点：武康路
- 人物：周楠（不是"你朋友"）
- 时间：20分钟（不是"1小时"）

**检查点**：
- ✅ 所有条件是否准确
- ✅ 是否使用了准确的名字/地点/数字

---

### Round 7: 情绪相关记忆（中等）
**目标**：验证情绪标签和记忆的结合

**测试场景**：
1. Moment 1: "今天在地铁上社死，手机铃声是'你好你好'，全车厢的人都看我"
2. Moment 2: 用户问"你还记得我在地铁上社死的时候，手机铃声是什么吗？"

**预期结果**：
- 铃声：'你好你好'
- 情绪：embarrassment/awkward

**检查点**：
- ✅ 是否正确检索到铃声
- ✅ 情绪标签是否正确

---

### Round 8: 长期记忆（10+ Moments后）
**目标**：验证在大量Moments后仍能准确记忆

**测试场景**：
1. Moment 1-10: 各种话题的对话
2. Moment 11: 用户问第一个Moment中提到的事实

**预期结果**：应该能准确回答第一个Moment的内容

**检查点**：
- ✅ 是否能在大量数据中找到早期记忆
- ✅ 检索速度是否可接受

---

## 🔄 测试流程

### 每轮测试步骤：
1. **准备测试数据**：创建测试脚本或手动输入
2. **运行测试**：执行对话流程
3. **记录结果**：记录Agent的回复
4. **分析问题**：对比预期和实际结果
5. **快速修复**：如有问题，立即修复代码
6. **重新测试**：验证修复是否有效

### 问题分类：
- **P0（严重）**：编造内容、完全错误 → 立即修复
- **P1（重要）**：部分错误、模糊表达 → 优先修复
- **P2（轻微）**：表达不够自然 → 后续优化

---

## 📊 测试记录模板

```
Round X: [测试名称]
日期: [日期]
测试场景: [描述]
预期结果: [描述]
实际结果: [Agent回复]
✅/❌: [结果]
问题分析: [如有问题，分析原因]
修复方案: [如有问题，提出修复方案]
```

---

## 🎯 成功标准

**通过标准**：
- ✅ 跨Moment记忆准确率 > 95%
- ✅ 未提及内容承认率 = 100%（不编造）
- ✅ 复杂查询准确率 > 90%
- ✅ 情绪标签准确率 > 85%

**如果达到标准**：可以进入 Phase 2（前端重构）

**如果未达到标准**：继续修复和测试

---

## 📝 注意事项

1. **每次测试后立即记录**：不要等到最后才记录
2. **快速迭代**：发现问题立即修复，不要积累
3. **保留测试数据**：保存每次测试的Moments，便于回溯
4. **对比分析**：对比不同轮次的结果，找出模式


